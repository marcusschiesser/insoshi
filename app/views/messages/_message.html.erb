<li class="message">
  <div class="profile-image">
    <% other_person = current_person?(message.sender) ?
                      message.recipient : message.sender %>
    <%= image_link other_person, :image => :thumbnail,
                   :image_options => { :class => "photo" } %>

    <%- if not message.read? and not current_person?(message.sender) -%>
      <%= image_tag("icons/email.gif", :class => "icon") %>
    <%- elsif message.replied_to? -%>
      <%= image_tag("icons/reply.gif", :class => "icon" )  %>
    <%- end -%>    
  </div>
  <p>
    <%- if current_person?(message.sender) -%>
      <span class="label"><%= _("To:") %></span>
      <%= person_link message.recipient, :class => "url fn" %>
    <%- else -%>
      <span class="label"><%= _("From:") %></span>
      <%= person_link message.sender, :class => "url fn" %>
    <%- end -%>
    <span class="meta"><%= time_ago_with_ago message.created_at %></span>
  </p>
  <p>
    <span class="label"><%= _("Subject:") %></span>
    <%= link_to sanitize(message.subject), message %>    
  </p>
  <p class="tools meta">
    <%= link_to _("Read"), message %> |
    <%= link_to _("Reply"), reply_message_path(message) %> |
    <% unless message.trashed?(current_person) -%>
      <%= link_to(_("Trash"), message, :method => :delete) %>
    <% else -%>
      <%= link_to _("Untrash"), undestroy_message_path(message), 
                             :method => :put %>
    <% end -%>    
  </p>
</li>